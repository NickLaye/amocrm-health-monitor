#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Å—Ç–∞—Ä—ã–º –∏ –Ω–æ–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º

cd "$(dirname "$0")/client/src"

show_help() {
    echo "üé® –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–∏–∑–∞–π–Ω–∞ amoCRM Health Monitor"
    echo ""
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:"
    echo "  ./switch-design.sh [option]"
    echo ""
    echo "–û–ø—Ü–∏–∏:"
    echo "  new-demo       - –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"
    echo "  new-real       - –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"
    echo "  old            - –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–º—É –¥–∏–∑–∞–π–Ω—É"
    echo "  status         - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω"
    echo "  help           - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É"
    echo ""
}

show_status() {
    echo "üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:"
    echo ""
    
    if [ -f "App.old.js" ]; then
        echo "‚úÖ –°—Ç–∞—Ä—ã–π –¥–∏–∑–∞–π–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫ App.old.js"
    fi
    
    if [ -f "App.new.js" ]; then
        echo "‚úÖ –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω (demo) –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ App.new.js"
    fi
    
    if [ -f "App.integrated.js" ]; then
        echo "‚úÖ –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω (—Å –¥–∞–Ω–Ω—ã–º–∏) –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ App.integrated.js"
    fi
    
    echo ""
    echo "üìù –ê–∫—Ç–∏–≤–Ω—ã–π App.js:"
    head -n 10 App.js | grep -E "import|amoCRM|HealthMonitor"
}

case "$1" in
    "new-demo")
        echo "üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏..."
        
        # –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
        if [ ! -f "App.old.js" ] && [ -f "App.js" ]; then
            cp App.js App.old.js
            echo "üíæ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è: App.old.js"
        fi
        
        # –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥–µ–º–æ –≤–µ—Ä—Å–∏—é
        if [ -f "App.new.js" ]; then
            cp App.new.js App.js
            echo "‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω (—Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)"
            echo "üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ: cd client && npm start"
        else
            echo "‚ùå –§–∞–π–ª App.new.js –Ω–µ –Ω–∞–π–¥–µ–Ω"
            exit 1
        fi
        ;;
        
    "new-real")
        echo "üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏..."
        
        # –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
        if [ ! -f "App.old.js" ] && [ -f "App.js" ]; then
            cp App.js App.old.js
            echo "üíæ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è: App.old.js"
        fi
        
        # –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
        if [ -f "App.integrated.js" ]; then
            cp App.integrated.js App.js
            echo "‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)"
            echo "üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ: cd client && npm start"
        else
            echo "‚ùå –§–∞–π–ª App.integrated.js –Ω–µ –Ω–∞–π–¥–µ–Ω"
            exit 1
        fi
        ;;
        
    "old")
        echo "üîÑ –í–æ–∑–≤—Ä–∞—Ç –∫ —Å—Ç–∞—Ä–æ–º—É –¥–∏–∑–∞–π–Ω—É..."
        
        if [ -f "App.old.js" ]; then
            cp App.old.js App.js
            echo "‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞—Ä—ã–π –¥–∏–∑–∞–π–Ω"
            echo "üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ: cd client && npm start"
        else
            echo "‚ùå –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è App.old.js –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
            exit 1
        fi
        ;;
        
    "status")
        show_status
        ;;
        
    "help"|"--help"|"-h"|"")
        show_help
        ;;
        
    *)
        echo "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ–ø—Ü–∏—è: $1"
        echo ""
        show_help
        exit 1
        ;;
esac

